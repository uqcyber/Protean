# Protean - Collation & API Dispatcher
### Collation
This folder facilitates running the <span style="
display: inline-flex;
justify-content: center;
line-height: 14px;
border-radius: 5px; 
background-image: linear-gradient(to right, #D76F84, #EF86C9, #9761DB);
padding: 0.25em; 
color: white;
"> PROTEAN</span> pipeline via shell scripts and collating the outputs of all enabled tools into a single global JSON view.

Example outputs may be found at the end of this README.

### API Dispatcher
The API <span style="
display: inline-flex;
justify-content: center;
line-height: 14px;
width: 100px;
text-align: center;
border-radius: 5px;
background: #facd62;
padding: 0.25em; 
color: #303030;
font-weight: bold;
"> DISPATCHER </span> provides methods to use <span style="
display: inline-flex;
justify-content: center;
line-height: 14px;
border-radius: 5px; 
background-image: linear-gradient(to right, #D76F84, #EF86C9, #9761DB);
padding: 0.25em; 
color: white;
"> PROTEAN</span>'s *global view* (specifically observables) with additional APIs. The currently supported APIs are:
+ OTX Alienvault
+ ThreatMiner
+ VirusTotal

By altering the api_filters.json file, the observables processed by each API and any maximum request limits can be configured.
API keys should be provided in /config/api_keys.json in the following format:

```json
{
    "otx_api": "API_KEY_HERE",
    "vt_api": "API_KEY_HERE"
}
```

An example output can be found at the end of this README.

##### Filtering
A simple filtering configuration has been provided (/config/api_filters.json) that allows for toggling of which tools will process observables of a given type (e.g. ipv4 addresses), as well as specifying a maximum amount

#### Global View Output
The following is an excerpt of a global view generated by the collation script.

```json
{
    "meta": {
        "tools": [
            "ioc-finder",
            "machinae",
        ]
    },
    "ioc-finder": {
        "ipv4s": ["192.168.0.1"]
    },
    "machinae": [
        {
            "site": "Fortinet Category",
            "results": {
                "Fortinet URL Category": "Newly Observed Domain"
            },
            "observable": "11:56:38",
            "observable type": "fqdn",
            "observable type detected": true
        }
    ],
    }
}
```

#### API Dispatcher Output

```json
{
    "otx_api_results":{
        "d085ba82824c1e61e93e113a705b8e9a": {
            "general": {
                "sections": [
                    "general"
                ],
                "type": "md5",
                "type_title": "FileHash-MD5",
                "indicator": "d085ba82824c1e61e93e113a705b8e9a",
                "validation": [],
                "base_indicator": {
                    "id": 2245460489,
                    "indicator": "09412575bceda6923f01d029a25536750e9feaa4130d4f91f6a372c554168737",
                    "type": "FileHash-SHA256",
                    "title": "",
                    "description": "",
                    "content": "",
                    "access_type": "public",
                    "access_reason": ""
                }
    },

    "threatminer_api_results": {
        "md5s": {
            "report tagging": {
                "d085ba82824c1e61e93e113a705b8e9a": [
                    {
                        "filename": "TheNaikonAPT-Securelist.pdf",
                        "year": "2015",
                        "URL": "https://www.threatminer.org/report.php?q=TheNaikonAPT-Securelist.pdf&y=2015"
                    },
                    {
                        "filename": "TheNaikonAPT-Securelist.pdf",
                        "year": "2015",
                        "URL": "https://www.threatminer.org/report.php?q=TheNaikonAPT-Securelist.pdf&y=2015"
                    }
                ]
            }
        }
    },

    "virustotal_api_results": {
        "domains": {
            "[Protean] domain redacted": {
                "last_analysis_stats": {
                    "harmless": 81,
                    "malicious": 1,
                    "suspicious": 0,
                    "timeout": 0,
                    "undetected": 10
                },
                "last_analysis_results": {
                    "ADMINUSLabs": {
                        "category": "harmless",
                        "engine_name": "ADMINUSLabs",
                        "method": "blacklist",
                        "result": "clean"
                    }
                }
            }
        }
    }
}
```
